<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>chain-handler-report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:5,&quot;tests&quot;:20,&quot;passes&quot;:20,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2024-03-06T14:38:10.417Z&quot;,&quot;end&quot;:&quot;2024-03-06T14:38:11.151Z&quot;,&quot;duration&quot;:734,&quot;testsRegistered&quot;:20,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;ec05386f-c75c-4d34-bcfe-ee86c725340e&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8feb850e-b762-45f0-944f-f83692f6b1bd&quot;,&quot;title&quot;:&quot;HandlerChain&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;34fcdb17-a54b-47fa-9c30-7381f6008143&quot;,&quot;title&quot;:&quot;status code&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;404&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code 404&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ch = new src_1.HandlerChain();\nch.addHandler({\n    handlers: [({ request, next, store }) =&gt; {\n            if (request.action === &#x27;hello&#x27;) {\n                store.counter++;\n            }\n            return next();\n        }],\n    store: { counter: 0 },\n});\nconst actual = await ch.handleRequest({\n    action: &#x27;hello&#x27;,\n    message: 1,\n});\nchai_1.assert.deepEqual(actual.status, 404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ee400b47-ddcf-4662-ace1-5380eb51a088&quot;,&quot;parentUUID&quot;:&quot;34fcdb17-a54b-47fa-9c30-7381f6008143&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;500&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code 500&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ch = new src_1.HandlerChain();\nconst err = new Error(&#x27;abc&#x27;);\nch.addHandler(() =&gt; {\n    throw err;\n});\nconst actual = await ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(actual.status, 500);\nchai_1.assert.deepEqual(actual.error, err);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3946d19f-2698-4c95-84c0-e3e5d3d55eb4&quot;,&quot;parentUUID&quot;:&quot;34fcdb17-a54b-47fa-9c30-7381f6008143&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;200&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ch = new src_1.HandlerChain();\nch.addHandler(() =&gt; { });\nconst actual = await ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.isUndefined(actual.error);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e6ec44fb-9833-4f4c-963e-962b9f21a05c&quot;,&quot;parentUUID&quot;:&quot;34fcdb17-a54b-47fa-9c30-7381f6008143&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setStatus no error&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code setStatus no error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectStatus = &#x27;myStatus&#x27;;\nconst ch = new src_1.HandlerChain();\nch.addHandler(({ setStatus }) =&gt; { setStatus(expectStatus); });\nconst actual = await ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(actual.status, expectStatus);\nchai_1.assert.isUndefined(actual.error);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ca1398c-0296-4c8b-a8bc-b6fc4dc1b162&quot;,&quot;parentUUID&quot;:&quot;34fcdb17-a54b-47fa-9c30-7381f6008143&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setStatus with error&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code setStatus with error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectStatus = &#x27;my status&#x27;;\nconst expectError = new Error(&#x27;my error&#x27;);\nconst ch = new src_1.HandlerChain();\nch.addHandler(({ setStatus }) =&gt; { setStatus(expectStatus, expectError); });\nconst actual = await ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(actual.status, expectStatus);\nchai_1.assert.deepEqual(actual.error, expectError);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d064bc42-bdd7-4617-b32b-59710246f4fc&quot;,&quot;parentUUID&quot;:&quot;34fcdb17-a54b-47fa-9c30-7381f6008143&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getStatus&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code getStatus&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ch = new src_1.HandlerChain();\nconst status = [];\nconst error = new TypeError(&#x27;err&#x27;);\nch.addHandler({\n    handlers: [\n        ({ getStatus, setStatus, next, store }) =&gt; {\n            store.status.push(getStatus());\n            setStatus(1);\n            next();\n            store.status.push(getStatus());\n        },\n        ({ getStatus, setStatus, store }) =&gt; {\n            store.status.push(getStatus());\n            setStatus(2, error);\n        },\n    ],\n    store: { status },\n});\nawait ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(status, [\n    { status: 0, error: undefined },\n    { status: 1, error: undefined },\n    { status: 2, error },\n]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;67049716-4237-487e-b785-42ae700c3ce3&quot;,&quot;parentUUID&quot;:&quot;34fcdb17-a54b-47fa-9c30-7381f6008143&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ee400b47-ddcf-4662-ace1-5380eb51a088&quot;,&quot;3946d19f-2698-4c95-84c0-e3e5d3d55eb4&quot;,&quot;e6ec44fb-9833-4f4c-963e-962b9f21a05c&quot;,&quot;8ca1398c-0296-4c8b-a8bc-b6fc4dc1b162&quot;,&quot;d064bc42-bdd7-4617-b32b-59710246f4fc&quot;,&quot;67049716-4237-487e-b785-42ae700c3ce3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0},{&quot;uuid&quot;:&quot;5159e7f2-71ee-404c-aec6-35093dbf9b80&quot;,&quot;title&quot;:&quot;context&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;request.handler fn&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context request.handler fn&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(async ({ request }) =&gt; { });\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2517fcac-fc7f-4927-ac0d-50212d28bc43&quot;,&quot;parentUUID&quot;:&quot;5159e7f2-71ee-404c-aec6-35093dbf9b80&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;request.handler fn sync&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context request.handler fn sync&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:509,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.slow(1400);\nconst expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(async () =&gt; {\n    await sleep(500);\n});\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7341f24f-db68-4122-ae9d-bf4a0148db28&quot;,&quot;parentUUID&quot;:&quot;5159e7f2-71ee-404c-aec6-35093dbf9b80&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;request.handler priority&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context request.handler priority&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(() =&gt; 2, 10)\n    .addHandler(() =&gt; 1, 5);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(actual.response, 1);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;38795755-41f1-4d7c-80eb-84e6b7d4238c&quot;,&quot;parentUUID&quot;:&quot;5159e7f2-71ee-404c-aec6-35093dbf9b80&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;request.action&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context request.action&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(({ request }) =&gt; {\n    return request.action;\n});\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(actual.response, expectReq.action);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4629dddf-e3d5-40f1-b158-f4a6b183f2b6&quot;,&quot;parentUUID&quot;:&quot;5159e7f2-71ee-404c-aec6-35093dbf9b80&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response chain&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context response chain&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch\n    .addHandler(({ next }) =&gt; {\n    return next() + &#x27;1&#x27;;\n})\n    .addHandler(({ next }) =&gt; {\n    return next() + &#x27;2&#x27;;\n})\n    .addHandler(() =&gt; &#x27;3&#x27;);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(actual.response, &#x27;321&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a467000-385c-4762-b0fa-4a8a0047dfaf&quot;,&quot;parentUUID&quot;:&quot;5159e7f2-71ee-404c-aec6-35093dbf9b80&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;store&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context store&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27;, message: &#x27;def&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { counter: 0 };\nch.addHandler({\n    handlers: ({ store }) =&gt; {\n        return store.counter++;\n    },\n    store,\n});\nawait ch.handleRequest(expectReq);\nawait ch.handleRequest(expectReq);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(actual.response, 2);\nchai_1.assert.deepEqual(store.counter, 3);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b8da89e2-96b2-4985-af24-22f29b1d44fc&quot;,&quot;parentUUID&quot;:&quot;5159e7f2-71ee-404c-aec6-35093dbf9b80&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2517fcac-fc7f-4927-ac0d-50212d28bc43&quot;,&quot;7341f24f-db68-4122-ae9d-bf4a0148db28&quot;,&quot;38795755-41f1-4d7c-80eb-84e6b7d4238c&quot;,&quot;4629dddf-e3d5-40f1-b158-f4a6b183f2b6&quot;,&quot;5a467000-385c-4762-b0fa-4a8a0047dfaf&quot;,&quot;b8da89e2-96b2-4985-af24-22f29b1d44fc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:510,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0},{&quot;uuid&quot;:&quot;e0e43f4a-9db5-4940-b423-c2402003226f&quot;,&quot;title&quot;:&quot;chain&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;once&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain once&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler({\n    handlers: () =&gt; 1,\n    once: true,\n});\nch.addHandler({\n    handlers: () =&gt; 2,\n    once: true,\n});\nconst actual1 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual1.status, 200);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual2 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual2.status, 200);\nchai_1.assert.deepEqual(actual2.response, 2);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual3 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual3.status, 404);\nchai_1.assert.isUndefined(actual3.response);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;55414bb8-3f95-4520-9ab4-c0eaeb580605&quot;,&quot;parentUUID&quot;:&quot;e0e43f4a-9db5-4940-b423-c2402003226f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;once in Same set&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain once in Same set&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler({\n    handlers: [() =&gt; 1, () =&gt; 2],\n    once: true,\n});\nch.addHandler({\n    handlers: () =&gt; 3,\n    once: true,\n});\nconst actual1 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual1.status, 200);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual2 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual2.status, 200);\nchai_1.assert.deepEqual(actual2.response, 2);\nchai_1.assert.deepEqual(actual2.response, 2);\nconst actual3 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual3.status, 200);\nchai_1.assert.deepEqual(actual3.response, 3);\nchai_1.assert.deepEqual(actual3.response, 3);\nconst actual4 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual4.status, 404);\nchai_1.assert.isUndefined(actual4.response);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;af0a6855-3c21-42f6-941a-5c32d6c68720&quot;,&quot;parentUUID&quot;:&quot;e0e43f4a-9db5-4940-b423-c2402003226f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;remove handler&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain remove handler&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(({ removeHandler: removeHander }) =&gt; {\n    removeHander();\n    return 1;\n}).addHandler(() =&gt; 2);\nconst actual1 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual1.status, 200);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual2 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual2.status, 200);\nchai_1.assert.deepEqual(actual2.response, 2);\nchai_1.assert.deepEqual(actual2.response, 2);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;047ef721-296c-4168-be9b-354f0b659fc0&quot;,&quot;parentUUID&quot;:&quot;e0e43f4a-9db5-4940-b423-c2402003226f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;remove handler same set&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain remove handler same set&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler({\n    handlers: [\n        ({ removeHandler: removeHander }) =&gt; {\n            removeHander();\n            return 1;\n        },\n        () =&gt; 2\n    ],\n}).addHandler({\n    handlers: () =&gt; 3,\n});\nconst actual1 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual1.status, 200);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual2 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual2.status, 200);\nchai_1.assert.deepEqual(actual2.response, 3);\nchai_1.assert.deepEqual(actual2.response, 3);\nconst actual3 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual3.status, 200);\nchai_1.assert.deepEqual(actual3.response, 3);\nchai_1.assert.deepEqual(actual3.response, 3);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;25d5129a-583b-48ed-98e9-fee911617ba7&quot;,&quot;parentUUID&quot;:&quot;e0e43f4a-9db5-4940-b423-c2402003226f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a6a0c98d-65a1-4496-a259-5b3590a1f59e&quot;,&quot;title&quot;:&quot;next&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;next&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain next next&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { history: [] };\nch.addHandler({\n    handlers: ({ next, store: { history } }) =&gt; {\n        history.push(&#x27;before&#x27;);\n        next();\n        history.push(&#x27;after&#x27;);\n    },\n    store,\n}, 5)\n    .addHandler({\n    handlers: ({ store: { history } }) =&gt; {\n        history.push(&#x27;main&#x27;);\n    },\n    store,\n}, 10);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(store.history, [&#x27;before&#x27;, &#x27;main&#x27;, &#x27;after&#x27;]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;60776920-c004-4771-a87d-30577ce6c592&quot;,&quot;parentUUID&quot;:&quot;a6a0c98d-65a1-4496-a259-5b3590a1f59e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;next with edited request&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain next next with edited request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { history: [] };\nch.addHandler({\n    handlers: ({ request, next, store: { history } }) =&gt; {\n        history.push(&#x27;before&#x27;);\n        request.message = &#x27;edited&#x27;;\n        next();\n        history.push(&#x27;after&#x27;);\n    },\n    store,\n}, 5)\n    .addHandler({\n    handlers: ({ request: { message }, store: { history } }) =&gt; {\n        history.push(&#x27;main&#x27;);\n        history.push(message);\n    },\n    store,\n}, 10);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(store.history, [&#x27;before&#x27;, &#x27;main&#x27;, &#x27;edited&#x27;, &#x27;after&#x27;]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1deae55e-e446-48f1-88be-c82da01447d0&quot;,&quot;parentUUID&quot;:&quot;a6a0c98d-65a1-4496-a259-5b3590a1f59e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;nextSync&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain next nextSync&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { history: [] };\nch.addHandler({\n    handlers: ({ nextSync, store: { history } }) =&gt; {\n        history.push(&#x27;before&#x27;);\n        history.push(nextSync());\n        history.push(&#x27;after&#x27;);\n    },\n    store,\n}, 5)\n    .addHandler({\n    handlers: () =&gt; {\n        return &#x27;main&#x27;;\n    },\n    store,\n}, 10);\nconst actual = ch.handleRequestSync(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(store.history, [&#x27;before&#x27;, &#x27;main&#x27;, &#x27;after&#x27;]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;343f6d68-0f9e-4f7c-8edf-e44f190c69ab&quot;,&quot;parentUUID&quot;:&quot;a6a0c98d-65a1-4496-a259-5b3590a1f59e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;nextAsync&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain next nextAsync&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:208,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.slow(500);\nconst expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { history: [] };\nch.addHandler({\n    handlers: async ({ nextAsync, store: { history } }) =&gt; {\n        history.push(&#x27;before&#x27;);\n        history.push(await nextAsync());\n        history.push(&#x27;after&#x27;);\n    },\n    store,\n}, 5)\n    .addHandler({\n    handlers: async () =&gt; {\n        await sleep(200);\n        return &#x27;main&#x27;;\n    },\n    store,\n}, 10);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(store.history, [&#x27;before&#x27;, &#x27;main&#x27;, &#x27;after&#x27;]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f0e4c18b-7fc3-4275-bcb6-352c19291bb3&quot;,&quot;parentUUID&quot;:&quot;a6a0c98d-65a1-4496-a259-5b3590a1f59e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;60776920-c004-4771-a87d-30577ce6c592&quot;,&quot;1deae55e-e446-48f1-88be-c82da01447d0&quot;,&quot;343f6d68-0f9e-4f7c-8edf-e44f190c69ab&quot;,&quot;f0e4c18b-7fc3-4275-bcb6-352c19291bb3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:209,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[&quot;55414bb8-3f95-4520-9ab4-c0eaeb580605&quot;,&quot;af0a6855-3c21-42f6-941a-5c32d6c68720&quot;,&quot;047ef721-296c-4168-be9b-354f0b659fc0&quot;,&quot;25d5129a-583b-48ed-98e9-fee911617ba7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:0}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.3.0&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;index&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;docs&quot;,&quot;reportTitle&quot;:&quot;chain-handler&quot;,&quot;reportPageTitle&quot;:&quot;chain-handler-report&quot;,&quot;reportFilename&quot;:&quot;index&quot;,&quot;autoOpen&quot;:&quot;true&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;index&quot;,&quot;reportDir&quot;:&quot;docs&quot;,&quot;reportTitle&quot;:&quot;chain-handler&quot;,&quot;reportPageTitle&quot;:&quot;chain-handler-report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:true,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;docs\\assets&quot;,&quot;jsonFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\docs\\index.json&quot;,&quot;htmlFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\docs\\index.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>