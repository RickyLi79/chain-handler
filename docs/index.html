<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Rich-JSON-report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:5,&quot;tests&quot;:20,&quot;passes&quot;:20,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2024-03-06T14:30:42.870Z&quot;,&quot;end&quot;:&quot;2024-03-06T14:30:43.597Z&quot;,&quot;duration&quot;:727,&quot;testsRegistered&quot;:20,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;e03c3eb5-9d3d-471b-a490-ec85a4605f4a&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0220510f-c676-48ab-b0fd-bf2b8afd0ae3&quot;,&quot;title&quot;:&quot;HandlerChain&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;03d78072-bb58-46c0-8f41-c1824c942698&quot;,&quot;title&quot;:&quot;status code&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;404&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code 404&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ch = new src_1.HandlerChain();\nch.addHandler({\n    handlers: [({ request, next, store }) =&gt; {\n            if (request.action === &#x27;hello&#x27;) {\n                store.counter++;\n            }\n            return next();\n        }],\n    store: { counter: 0 },\n});\nconst actual = await ch.handleRequest({\n    action: &#x27;hello&#x27;,\n    message: 1,\n});\nchai_1.assert.deepEqual(actual.status, 404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f35fa5d-ede3-440b-96e3-2583e28681c7&quot;,&quot;parentUUID&quot;:&quot;03d78072-bb58-46c0-8f41-c1824c942698&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;500&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code 500&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ch = new src_1.HandlerChain();\nconst err = new Error(&#x27;abc&#x27;);\nch.addHandler(() =&gt; {\n    throw err;\n});\nconst actual = await ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(actual.status, 500);\nchai_1.assert.deepEqual(actual.error, err);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d061e22-0aef-4293-a7d2-776f90f63839&quot;,&quot;parentUUID&quot;:&quot;03d78072-bb58-46c0-8f41-c1824c942698&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;200&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ch = new src_1.HandlerChain();\nch.addHandler(() =&gt; { });\nconst actual = await ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.isUndefined(actual.error);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6c0e470-596a-4565-ad7a-f9037f855396&quot;,&quot;parentUUID&quot;:&quot;03d78072-bb58-46c0-8f41-c1824c942698&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setStatus no error&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code setStatus no error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectStatus = &#x27;myStatus&#x27;;\nconst ch = new src_1.HandlerChain();\nch.addHandler(({ setStatus }) =&gt; { setStatus(expectStatus); });\nconst actual = await ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(actual.status, expectStatus);\nchai_1.assert.isUndefined(actual.error);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dade399c-2cb3-4c4f-a89a-5c0e41fd5812&quot;,&quot;parentUUID&quot;:&quot;03d78072-bb58-46c0-8f41-c1824c942698&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setStatus with error&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code setStatus with error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectStatus = &#x27;my status&#x27;;\nconst expectError = new Error(&#x27;my error&#x27;);\nconst ch = new src_1.HandlerChain();\nch.addHandler(({ setStatus }) =&gt; { setStatus(expectStatus, expectError); });\nconst actual = await ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(actual.status, expectStatus);\nchai_1.assert.deepEqual(actual.error, expectError);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;09785e86-561e-4d97-90e9-85bc81416fd9&quot;,&quot;parentUUID&quot;:&quot;03d78072-bb58-46c0-8f41-c1824c942698&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getStatus&quot;,&quot;fullTitle&quot;:&quot;HandlerChain status code getStatus&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ch = new src_1.HandlerChain();\nconst status = [];\nconst error = new TypeError(&#x27;err&#x27;);\nch.addHandler({\n    handlers: [\n        ({ getStatus, setStatus, next, store }) =&gt; {\n            store.status.push(getStatus());\n            setStatus(1);\n            next();\n            store.status.push(getStatus());\n        },\n        ({ getStatus, setStatus, store }) =&gt; {\n            store.status.push(getStatus());\n            setStatus(2, error);\n        },\n    ],\n    store: { status },\n});\nawait ch.handleRequest({ action: &#x27;123&#x27; });\nchai_1.assert.deepEqual(status, [\n    { status: 0, error: undefined },\n    { status: 1, error: undefined },\n    { status: 2, error },\n]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8572f5b3-5de4-4e5d-b2b0-dc3e3444a666&quot;,&quot;parentUUID&quot;:&quot;03d78072-bb58-46c0-8f41-c1824c942698&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4f35fa5d-ede3-440b-96e3-2583e28681c7&quot;,&quot;4d061e22-0aef-4293-a7d2-776f90f63839&quot;,&quot;a6c0e470-596a-4565-ad7a-f9037f855396&quot;,&quot;dade399c-2cb3-4c4f-a89a-5c0e41fd5812&quot;,&quot;09785e86-561e-4d97-90e9-85bc81416fd9&quot;,&quot;8572f5b3-5de4-4e5d-b2b0-dc3e3444a666&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0},{&quot;uuid&quot;:&quot;57741804-f31f-4fa8-91eb-1624a2ce1253&quot;,&quot;title&quot;:&quot;context&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;request.handler fn&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context request.handler fn&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(async ({ request }) =&gt; { });\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d16f4322-eac6-4725-a8e1-87172a38ecce&quot;,&quot;parentUUID&quot;:&quot;57741804-f31f-4fa8-91eb-1624a2ce1253&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;request.handler fn sync&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context request.handler fn sync&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:500,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.slow(1400);\nconst expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(async () =&gt; {\n    await sleep(500);\n});\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;25cc164f-8c27-4422-82ca-193f26ab20a0&quot;,&quot;parentUUID&quot;:&quot;57741804-f31f-4fa8-91eb-1624a2ce1253&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;request.handler priority&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context request.handler priority&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(() =&gt; 2, 10)\n    .addHandler(() =&gt; 1, 5);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(actual.response, 1);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e7e36d0b-1f94-4ca6-987b-fea6870daea5&quot;,&quot;parentUUID&quot;:&quot;57741804-f31f-4fa8-91eb-1624a2ce1253&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;request.action&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context request.action&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(({ request }) =&gt; {\n    return request.action;\n});\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(actual.response, expectReq.action);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fb22159d-1329-49da-a5da-4e4d4ba4073c&quot;,&quot;parentUUID&quot;:&quot;57741804-f31f-4fa8-91eb-1624a2ce1253&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response chain&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context response chain&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch\n    .addHandler(({ next }) =&gt; {\n    return next() + &#x27;1&#x27;;\n})\n    .addHandler(({ next }) =&gt; {\n    return next() + &#x27;2&#x27;;\n})\n    .addHandler(() =&gt; &#x27;3&#x27;);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(actual.response, &#x27;321&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc6f62c6-4ba4-47e3-80e1-09be293aaa42&quot;,&quot;parentUUID&quot;:&quot;57741804-f31f-4fa8-91eb-1624a2ce1253&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;store&quot;,&quot;fullTitle&quot;:&quot;HandlerChain context store&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27;, message: &#x27;def&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { counter: 0 };\nch.addHandler({\n    handlers: ({ store }) =&gt; {\n        return store.counter++;\n    },\n    store,\n});\nawait ch.handleRequest(expectReq);\nawait ch.handleRequest(expectReq);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(actual.response, 2);\nchai_1.assert.deepEqual(store.counter, 3);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa8ffa1f-b016-4a81-9ff4-0071b2feccc4&quot;,&quot;parentUUID&quot;:&quot;57741804-f31f-4fa8-91eb-1624a2ce1253&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d16f4322-eac6-4725-a8e1-87172a38ecce&quot;,&quot;25cc164f-8c27-4422-82ca-193f26ab20a0&quot;,&quot;e7e36d0b-1f94-4ca6-987b-fea6870daea5&quot;,&quot;fb22159d-1329-49da-a5da-4e4d4ba4073c&quot;,&quot;dc6f62c6-4ba4-47e3-80e1-09be293aaa42&quot;,&quot;fa8ffa1f-b016-4a81-9ff4-0071b2feccc4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:502,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0},{&quot;uuid&quot;:&quot;6dc2f902-4c54-4d02-b6c4-853ba4b3eaa2&quot;,&quot;title&quot;:&quot;chain&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;once&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain once&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler({\n    handlers: () =&gt; 1,\n    once: true,\n});\nch.addHandler({\n    handlers: () =&gt; 2,\n    once: true,\n});\nconst actual1 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual1.status, 200);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual2 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual2.status, 200);\nchai_1.assert.deepEqual(actual2.response, 2);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual3 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual3.status, 404);\nchai_1.assert.isUndefined(actual3.response);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0093e988-8f9e-431c-bc8e-65f5d711dac0&quot;,&quot;parentUUID&quot;:&quot;6dc2f902-4c54-4d02-b6c4-853ba4b3eaa2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;once in Same set&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain once in Same set&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler({\n    handlers: [() =&gt; 1, () =&gt; 2],\n    once: true,\n});\nch.addHandler({\n    handlers: () =&gt; 3,\n    once: true,\n});\nconst actual1 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual1.status, 200);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual2 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual2.status, 200);\nchai_1.assert.deepEqual(actual2.response, 2);\nchai_1.assert.deepEqual(actual2.response, 2);\nconst actual3 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual3.status, 200);\nchai_1.assert.deepEqual(actual3.response, 3);\nchai_1.assert.deepEqual(actual3.response, 3);\nconst actual4 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual4.status, 404);\nchai_1.assert.isUndefined(actual4.response);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;45e8ffd0-6563-41e4-ba6b-5eda6104e208&quot;,&quot;parentUUID&quot;:&quot;6dc2f902-4c54-4d02-b6c4-853ba4b3eaa2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;remove handler&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain remove handler&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler(({ removeHandler: removeHander }) =&gt; {\n    removeHander();\n    return 1;\n}).addHandler(() =&gt; 2);\nconst actual1 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual1.status, 200);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual2 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual2.status, 200);\nchai_1.assert.deepEqual(actual2.response, 2);\nchai_1.assert.deepEqual(actual2.response, 2);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b4a21c85-c559-4678-9bf5-673c7389558c&quot;,&quot;parentUUID&quot;:&quot;6dc2f902-4c54-4d02-b6c4-853ba4b3eaa2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;remove handler same set&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain remove handler same set&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nch.addHandler({\n    handlers: [\n        ({ removeHandler: removeHander }) =&gt; {\n            removeHander();\n            return 1;\n        },\n        () =&gt; 2\n    ],\n}).addHandler({\n    handlers: () =&gt; 3,\n});\nconst actual1 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual1.status, 200);\nchai_1.assert.deepEqual(actual1.response, 1);\nconst actual2 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual2.status, 200);\nchai_1.assert.deepEqual(actual2.response, 3);\nchai_1.assert.deepEqual(actual2.response, 3);\nconst actual3 = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual3.status, 200);\nchai_1.assert.deepEqual(actual3.response, 3);\nchai_1.assert.deepEqual(actual3.response, 3);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52f9500e-db2d-430c-88ce-b7ca2cd2af4f&quot;,&quot;parentUUID&quot;:&quot;6dc2f902-4c54-4d02-b6c4-853ba4b3eaa2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;5950bf40-734d-41e7-8fb6-6537eb71b74b&quot;,&quot;title&quot;:&quot;next&quot;,&quot;fullFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\test\\index.test.ts&quot;,&quot;file&quot;:&quot;\\test\\index.test.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;next&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain next next&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { history: [] };\nch.addHandler({\n    handlers: ({ next, store: { history } }) =&gt; {\n        history.push(&#x27;before&#x27;);\n        next();\n        history.push(&#x27;after&#x27;);\n    },\n    store,\n}, 5)\n    .addHandler({\n    handlers: ({ store: { history } }) =&gt; {\n        history.push(&#x27;main&#x27;);\n    },\n    store,\n}, 10);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(store.history, [&#x27;before&#x27;, &#x27;main&#x27;, &#x27;after&#x27;]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;938eb826-4b09-4f46-a2b2-1c6e091b1e82&quot;,&quot;parentUUID&quot;:&quot;5950bf40-734d-41e7-8fb6-6537eb71b74b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;next with edited request&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain next next with edited request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { history: [] };\nch.addHandler({\n    handlers: ({ request, next, store: { history } }) =&gt; {\n        history.push(&#x27;before&#x27;);\n        request.message = &#x27;edited&#x27;;\n        next();\n        history.push(&#x27;after&#x27;);\n    },\n    store,\n}, 5)\n    .addHandler({\n    handlers: ({ request: { message }, store: { history } }) =&gt; {\n        history.push(&#x27;main&#x27;);\n        history.push(message);\n    },\n    store,\n}, 10);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(store.history, [&#x27;before&#x27;, &#x27;main&#x27;, &#x27;edited&#x27;, &#x27;after&#x27;]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;60e279f7-5e95-4c0c-adf5-e91d4316c6ff&quot;,&quot;parentUUID&quot;:&quot;5950bf40-734d-41e7-8fb6-6537eb71b74b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;nextSync&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain next nextSync&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { history: [] };\nch.addHandler({\n    handlers: ({ nextSync, store: { history } }) =&gt; {\n        history.push(&#x27;before&#x27;);\n        history.push(nextSync());\n        history.push(&#x27;after&#x27;);\n    },\n    store,\n}, 5)\n    .addHandler({\n    handlers: () =&gt; {\n        return &#x27;main&#x27;;\n    },\n    store,\n}, 10);\nconst actual = ch.handleRequestSync(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(store.history, [&#x27;before&#x27;, &#x27;main&#x27;, &#x27;after&#x27;]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;090175c6-5553-4d51-bc86-109e3b83fc4c&quot;,&quot;parentUUID&quot;:&quot;5950bf40-734d-41e7-8fb6-6537eb71b74b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;nextAsync&quot;,&quot;fullTitle&quot;:&quot;HandlerChain chain next nextAsync&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:211,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.slow(500);\nconst expectReq = { action: &#x27;abc&#x27; };\nconst ch = new src_1.HandlerChain();\nconst store = { history: [] };\nch.addHandler({\n    handlers: async ({ nextAsync, store: { history } }) =&gt; {\n        history.push(&#x27;before&#x27;);\n        history.push(await nextAsync());\n        history.push(&#x27;after&#x27;);\n    },\n    store,\n}, 5)\n    .addHandler({\n    handlers: async () =&gt; {\n        await sleep(200);\n        return &#x27;main&#x27;;\n    },\n    store,\n}, 10);\nconst actual = await ch.handleRequest(expectReq);\nchai_1.assert.deepEqual(actual.status, 200);\nchai_1.assert.deepEqual(store.history, [&#x27;before&#x27;, &#x27;main&#x27;, &#x27;after&#x27;]);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0550d499-a787-45ca-a1ff-e4e25c7ac4ba&quot;,&quot;parentUUID&quot;:&quot;5950bf40-734d-41e7-8fb6-6537eb71b74b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;938eb826-4b09-4f46-a2b2-1c6e091b1e82&quot;,&quot;60e279f7-5e95-4c0c-adf5-e91d4316c6ff&quot;,&quot;090175c6-5553-4d51-bc86-109e3b83fc4c&quot;,&quot;0550d499-a787-45ca-a1ff-e4e25c7ac4ba&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:211,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[&quot;0093e988-8f9e-431c-bc8e-65f5d711dac0&quot;,&quot;45e8ffd0-6563-41e4-ba6b-5eda6104e208&quot;,&quot;b4a21c85-c559-4678-9bf5-673c7389558c&quot;,&quot;52f9500e-db2d-430c-88ce-b7ca2cd2af4f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:0}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.3.0&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;index&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;docs&quot;,&quot;reportTitle&quot;:&quot;Rich-JSON&quot;,&quot;reportPageTitle&quot;:&quot;Rich-JSON-report&quot;,&quot;reportFilename&quot;:&quot;index&quot;,&quot;autoOpen&quot;:&quot;true&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;index&quot;,&quot;reportDir&quot;:&quot;docs&quot;,&quot;reportTitle&quot;:&quot;Rich-JSON&quot;,&quot;reportPageTitle&quot;:&quot;Rich-JSON-report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:true,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;docs\\assets&quot;,&quot;jsonFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\docs\\index.json&quot;,&quot;htmlFile&quot;:&quot;D:\\works\\ts-project\\chain-handler\\docs\\index.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>